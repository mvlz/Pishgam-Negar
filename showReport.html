<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pishgam Negar</title>
    <link rel="stylesheet" href="assets/styles/style.css">
    <link href="assets/styles/gridjs-mermaid.min.css" rel="stylesheet" />

</head>

<body class="show-page">

    <header class="header-container">
        <a href="https://pishgamnegar.com">
            <img src="assets/Img/pn-logo.png" alt="" class="logo">
        </a>
        <a href="index.html" class="backBtn">
            بازگشت
            <span class="icon-Arrow---Left-2-1"></span>
        </a>

    </header>

    <div class="container">
        <!-- Report detail top of the grid js -->
        <section class="top-details">
            <h2 class="detail-title">گزارش فروش تجمیعی از ۱۴۰۰/۱۰/۰۱ تا ۱۴۰۰/۱۰/۲۰</h2>
        </section>

        <!-- Grid js  -->
        <div id="showReportModal"></div>
        <!-- /Grid js  -->

        <!-- Report detail bottom of the grid js -->
        <section class="bottom-details">
            <div class="detail-container">
                <h3 class="detail-title">مجموع پرداختی ها به تفکیک روش پرداخت</h3>
                <ul class="payment-list"></ul>
            </div>
            <div class="detail-container">
                <h3 class="detail-title">خلاصه گزارش</h3>
                <ul class="summary-list"></ul>
            </div>
        </section>
    </div>


    <div class="toast">
        <p class="notice"></p>
        <div class="toast-body">

        </div>
        <div class="close"></div>
    </div>
    <script src="js/gridjs.umd.js"></script>
    <script>
        // =-=-=-=-=-=-=  Grid JS  =-=-=-=-=-=-=//

        const grid = new gridjs.Grid({
            columns: [
                { id: 'id_order', name: 'شناسه سفارش' },
                {
                    id: 'customer_name',
                    name: 'نام مشتری',
                },
                { id: 'payment', name: 'روش پرداخت' },
                {
                    id: 'total_paid',
                    name: 'مبلغ پرداخت شده',
                    formatter: (cell) => cell > 0 ? ` ${cell.toLocaleString().replace(/\B(?=(\d{3})+(?!\d))/g, ",")} تومان` : "ندارد"
                },
                {
                    id: 'total_products',
                    name: 'جمع محصولات',
                    formatter: (cell) => cell > 0 ? ` ${cell.toLocaleString().replace(/\B(?=(\d{3})+(?!\d))/g, ",")} تومان` : "ندارد"
                },
                {
                    id: 'total_shipping',
                    name: 'هزینه حمل',
                    formatter: (cell) => cell > 0 ? ` ${cell.toLocaleString().replace(/\B(?=(\d{3})+(?!\d))/g, ",")} تومان` : "رایگان"
                },
                {
                    id: 'total_discounts_calc',
                    name: 'جمع تخفیفات',
                    formatter: (cell) => cell > 0 ? ` ${cell.toLocaleString().replace(/\B(?=(\d{3})+(?!\d))/g, ",")} تومان` : "ندارد"
                },
                { id: 'current_state_name', name: 'وضعیت سفارش' },
                {
                    id: 'order_date',
                    name: 'تاریخ سفارش',
                    sort: {
                        compare: (first, second) => {
                            let a = first.split(/[+-/*: ]+/)
                            let b = second.split(/[+-/*: ]+/)
                            if (parseInt(a[0]) > parseInt(b[0])
                                || parseInt(a[0]) === parseInt(b[0]) && parseInt(a[1]) > parseInt(b[1])
                                || parseInt(a[1]) === parseInt(b[1]) && parseInt(a[2]) > parseInt(b[2])
                                || parseInt(a[2]) === parseInt(b[2]) && parseInt(a[3]) > parseInt(b[3])
                                || parseInt(a[3]) === parseInt(b[3]) && parseInt(a[4]) > parseInt(b[4])
                                || parseInt(a[4]) === parseInt(b[4]) && parseInt(a[5]) > parseInt(b[5])
                            ) {
                                return 1;
                            } else if (parseInt(b[0]) > parseInt(a[0])
                                || parseInt(a[0]) === parseInt(b[0]) && parseInt(a[1]) < parseInt(b[1])
                                || parseInt(a[1]) === parseInt(b[1]) && parseInt(a[2]) < parseInt(b[2])
                                || parseInt(a[2]) === parseInt(b[2]) && parseInt(a[3]) < parseInt(b[3])
                                || parseInt(a[3]) === parseInt(b[3]) && parseInt(a[4]) < parseInt(b[4])
                                || parseInt(a[4]) === parseInt(b[4]) && parseInt(a[5]) < parseInt(b[5])
                            ) {
                                return -1;
                            } else {
                                return 0;
                            }
                        }
                    },
                },
                {
                    id: 'final_check', name: 'بررسی نهایی',
                    formatter: (cell) => {
                        return gridjs.html(`<span class='${(cell.split(' ').join('')).toLowerCase() === 'ok' ? 'finalTd-ok' : 'finalTd-notOk'}'>${cell}</span>`)
                        console.log(cell);
                    }
                }],
            data: [{ "id_order": 91927, "customer_name": "ز. شکراللهی زاده", "payment": "پاسارگاد", "total_paid": 691255, "total_products": 691255, "total_shipping": 0, "total_discounts_calc": 0, "current_state_name": "پرداخت تاييد شده", "order_date": "1400\/11\/1 18:33:23", "final_check": "OK" }, { "id_order": 91926, "customer_name": "س. حاجیپور", "payment": "پاسارگاد", "total_paid": 972715, "total_products": 956715, "total_shipping": 16000, "total_discounts_calc": 0, "current_state_name": "پرداخت تاييد شده", "order_date": "1400\/11\/1 18:06:56", "final_check": "OK" }, { "id_order": 91925, "customer_name": "پ. رحمت پور", "payment": "پاسارگاد", "total_paid": 189060, "total_products": 193060, "total_shipping": 16000, "total_discounts_calc": 20000, "current_state_name": "پرداخت تاييد شده", "order_date": "1400\/11\/1 17:40:04", "final_check": "OK" }, { "id_order": 91924, "customer_name": "ی. محصلی", "payment": "پاسارگاد", "total_paid": 340945, "total_products": 370945, "total_shipping": 0, "total_discounts_calc": 30000, "current_state_name": "پرداخت تاييد شده", "order_date": "1400\/11\/1 17:17:15", "final_check": "OK" }, { "id_order": 91923, "customer_name": "ا. جعفری", "payment": "پاسارگاد", "total_paid": 332345, "total_products": 316345, "total_shipping": 16000, "total_discounts_calc": 0, "current_state_name": "پرداخت تاييد شده", "order_date": "1400\/11\/1 16:43:20", "final_check": "OK" }, { "id_order": 91922, "customer_name": "ش. عسگرزاده", "payment": "پاسارگاد", "total_paid": 88000, "total_products": 72000, "total_shipping": 16000, "total_discounts_calc": 0, "current_state_name": "پرداخت تاييد شده", "order_date": "1400\/11\/1 16:32:46", "final_check": "OK" }, { "id_order": 91921, "customer_name": "ب. مظفری", "payment": "پاسارگاد", "total_paid": 150300, "total_products": 154300, "total_shipping": 16000, "total_discounts_calc": 20000, "current_state_name": "پرداخت تاييد شده", "order_date": "1400\/11\/1 16:28:39", "final_check": "OK" }, { "id_order": 91920, "customer_name": "آ. مهرپرور", "payment": "پاسارگاد", "total_paid": 276460, "total_products": 280460, "total_shipping": 16000, "total_discounts_calc": 20000, "current_state_name": "پرداخت تاييد شده", "order_date": "1400\/11\/1 16:01:48", "final_check": "OK" }, { "id_order": 91919, "customer_name": "ح. قاسم پور", "payment": "پاسارگاد", "total_paid": 150300, "total_products": 154300, "total_shipping": 16000, "total_discounts_calc": 20000, "current_state_name": "پرداخت تاييد شده", "order_date": "1400\/11\/1 15:51:46", "final_check": "OK" }, { "id_order": 91918, "customer_name": "ف. رحمت آبادی", "payment": "سداد(بانک ملی)", "total_paid": 386850, "total_products": 370850, "total_shipping": 16000, "total_discounts_calc": 0, "current_state_name": "پرداخت تاييد شده", "order_date": "1400\/11\/1 15:45:13", "final_check": "OK" }, { "id_order": 91917, "customer_name": "ا. جعفری", "payment": "پاسارگاد", "total_paid": 150300, "total_products": 154300, "total_shipping": 16000, "total_discounts_calc": 20000, "current_state_name": "پرداخت تاييد شده", "order_date": "1400\/11\/1 15:39:27", "final_check": "OK" }, { "id_order": 91916, "customer_name": " . روستایی", "payment": "پاسارگاد", "total_paid": 647088, "total_products": 726900, "total_shipping": 0, "total_discounts_calc": 79812, "current_state_name": "پرداخت تاييد شده", "order_date": "1400\/11\/1 14:53:47", "final_check": "OK" }, { "id_order": 91915, "customer_name": "ز. سرکوهیان", "payment": "پاسارگاد", "total_paid": 196010, "total_products": 200010, "total_shipping": 16000, "total_discounts_calc": 20000, "current_state_name": "پرداخت تاييد شده", "order_date": "1400\/11\/1 14:53:44", "final_check": "OK" }, { "id_order": 91914, "customer_name": "ف. دستجردی", "payment": "پاسارگاد", "total_paid": 169320, "total_products": 153320, "total_shipping": 16000, "total_discounts_calc": 0, "current_state_name": "پرداخت تاييد شده", "order_date": "1400\/11\/1 14:50:05", "final_check": "OK" }, { "id_order": 91913, "customer_name": "ش. آقاجان زاده", "payment": "سداد(بانک ملی)", "total_paid": 117150, "total_products": 121150, "total_shipping": 16000, "total_discounts_calc": 20000, "current_state_name": "پرداخت تاييد شده", "order_date": "1400\/11\/1 14:49:02", "final_check": "OK" }, { "id_order": 91911, "customer_name": "ف. زوهمند", "payment": "سداد(بانک ملی)", "total_paid": 126480, "total_products": 110480, "total_shipping": 16000, "total_discounts_calc": 0, "current_state_name": "پرداخت تاييد شده", "order_date": "1400\/11\/1 14:33:37", "final_check": "OK" }, { "id_order": 91910, "customer_name": "ف. جنیدی", "payment": "پاسارگاد", "total_paid": 183230, "total_products": 191230, "total_shipping": 12000, "total_discounts_calc": 20000, "current_state_name": "پرداخت تاييد شده", "order_date": "1400\/11\/1 14:26:18", "final_check": "OK" }, { "id_order": 91909, "customer_name": "ف. حسن زاده ", "payment": "پاسارگاد", "total_paid": 181940, "total_products": 169940, "total_shipping": 12000, "total_discounts_calc": 0, "current_state_name": "پرداخت تاييد شده", "order_date": "1400\/11\/1 13:49:00", "final_check": "OK" }, { "id_order": 91908, "customer_name": "-. شادی مرادی", "payment": "پاسارگاد", "total_paid": 238950, "total_products": 222950, "total_shipping": 16000, "total_discounts_calc": 0, "current_state_name": "پرداخت تاييد شده", "order_date": "1400\/11\/1 12:54:25", "final_check": "OK" }, { "id_order": 91907, "customer_name": "ن. رهیده", "payment": "پاسارگاد", "total_paid": 238950, "total_products": 222950, "total_shipping": 16000, "total_discounts_calc": 0, "current_state_name": "پرداخت تاييد شده", "order_date": "1400\/11\/1 12:36:39", "final_check": "OK" }, { "id_order": 91906, "customer_name": "ف. شیردل", "payment": "سداد(بانک ملی)", "total_paid": 246400, "total_products": 230400, "total_shipping": 16000, "total_discounts_calc": 0, "current_state_name": "پرداخت تاييد شده", "order_date": "1400\/11\/1 11:52:14", "final_check": "OK" }, { "id_order": 91905, "customer_name": "غ. داوودی", "payment": "پاسارگاد", "total_paid": 245885, "total_products": 229885, "total_shipping": 16000, "total_discounts_calc": 0, "current_state_name": "پرداخت تاييد شده", "order_date": "1400\/11\/1 11:41:09", "final_check": "OK" }, { "id_order": 91904, "customer_name": "ا. جلال پور", "payment": "پاسارگاد", "total_paid": 192300, "total_products": 176300, "total_shipping": 16000, "total_discounts_calc": 0, "current_state_name": "پرداخت تاييد شده", "order_date": "1400\/11\/1 11:40:57", "final_check": "OK" }, { "id_order": 91903, "customer_name": "آ. شالی بر", "payment": "پاسارگاد", "total_paid": 306424, "total_products": 306424, "total_shipping": 0, "total_discounts_calc": 0, "current_state_name": "پرداخت تاييد شده", "order_date": "1400\/11\/1 11:17:48", "final_check": "OK" }, { "id_order": 91902, "customer_name": "م. کیانی", "payment": "پاسارگاد", "total_paid": 117150, "total_products": 121150, "total_shipping": 16000, "total_discounts_calc": 20000, "current_state_name": "پرداخت تاييد شده", "order_date": "1400\/11\/1 10:35:45", "final_check": "OK" }, { "id_order": 91901, "customer_name": "م. زرک لو", "payment": "پاسارگاد", "total_paid": 228300, "total_products": 242300, "total_shipping": 16000, "total_discounts_calc": 30000, "current_state_name": "پرداخت تاييد شده", "order_date": "1400\/11\/1 08:20:19", "final_check": "OK" }, { "id_order": 91900, "customer_name": "ش. یوسفی", "payment": "پاسارگاد", "total_paid": 228170, "total_products": 212170, "total_shipping": 16000, "total_discounts_calc": 0, "current_state_name": "پرداخت تاييد شده", "order_date": "1400\/11\/1 03:30:47", "final_check": "OK" }, { "id_order": 91899, "customer_name": "ا. کیانی", "payment": "پاسارگاد", "total_paid": 461900, "total_products": 445900, "total_shipping": 16000, "total_discounts_calc": 0, "current_state_name": "پرداخت تاييد شده", "order_date": "1400\/11\/1 02:36:29", "final_check": "OK" }, { "id_order": 91898, "customer_name": "ر. مومني", "payment": "سداد(بانک ملی)", "total_paid": 261450, "total_products": 275450, "total_shipping": 16000, "total_discounts_calc": 30000, "current_state_name": "پرداخت تاييد شده", "order_date": "1400\/11\/1 02:07:04", "final_check": "OK" }, { "id_order": 91897, "customer_name": "م. قیدی", "payment": "سداد(بانک ملی)", "total_paid": 505370, "total_products": 505370, "total_shipping": 0, "total_discounts_calc": 0, "current_state_name": "پرداخت تاييد شده", "order_date": "1400\/11\/1 01:58:50", "final_check": "OK" }, { "id_order": 91896, "customer_name": "م. گلستانی", "payment": "پاسارگاد", "total_paid": 117150, "total_products": 121150, "total_shipping": 16000, "total_discounts_calc": 20000, "current_state_name": "پرداخت تاييد شده", "order_date": "1400\/11\/1 00:34:08", "final_check": "OK" }, { "id_order": 91895, "customer_name": "م. رمضانی", "payment": "پاسارگاد", "total_paid": 295910, "total_products": 279910, "total_shipping": 16000, "total_discounts_calc": 0, "current_state_name": "پرداخت تاييد شده", "order_date": "1400\/10\/30 23:54:55", "final_check": "OK" }, { "id_order": 91894, "customer_name": "ف. مرادنوری ", "payment": "پاسارگاد", "total_paid": 492200, "total_products": 476200, "total_shipping": 16000, "total_discounts_calc": 0, "current_state_name": "پرداخت تاييد شده", "order_date": "1400\/10\/30 23:33:32", "final_check": "OK" }, { "id_order": 91893, "customer_name": "م. افخمی", "payment": "پاسارگاد", "total_paid": 129610, "total_products": 113610, "total_shipping": 16000, "total_discounts_calc": 0, "current_state_name": "پرداخت تاييد شده", "order_date": "1400\/10\/30 23:29:19", "final_check": "OK" }, { "id_order": 91892, "customer_name": "س. هاشمی", "payment": "پاسارگاد", "total_paid": 33150, "total_products": 33150, "total_shipping": 16000, "total_discounts_calc": 16000, "current_state_name": "پرداخت تاييد شده", "order_date": "1400\/10\/30 23:19:04", "final_check": "OK" }, { "id_order": 91891, "customer_name": "ش. بیات", "payment": "پاسارگاد", "total_paid": 130750, "total_products": 114750, "total_shipping": 16000, "total_discounts_calc": 0, "current_state_name": "پرداخت تاييد شده", "order_date": "1400\/10\/30 22:09:13", "final_check": "OK" }, { "id_order": 91890, "customer_name": "ن. کوثری", "payment": "پاسارگاد", "total_paid": 150300, "total_products": 154300, "total_shipping": 16000, "total_discounts_calc": 20000, "current_state_name": "پرداخت تاييد شده", "order_date": "1400\/10\/30 22:07:05", "final_check": "OK" }, { "id_order": 91889, "customer_name": "س. هاشمی", "payment": "پاسارگاد", "total_paid": 167550, "total_products": 171550, "total_shipping": 16000, "total_discounts_calc": 20000, "current_state_name": "پرداخت تاييد شده", "order_date": "1400\/10\/30 21:12:11", "final_check": "OK" }, { "id_order": 91888, "customer_name": "آ. مغانلو", "payment": "پاسارگاد", "total_paid": 383395, "total_products": 383395, "total_shipping": 0, "total_discounts_calc": 0, "current_state_name": "پرداخت تاييد شده", "order_date": "1400\/10\/30 18:53:17", "final_check": "OK" }, { "id_order": 91887, "customer_name": "ن. مدرسی", "payment": "پاسارگاد", "total_paid": 180365, "total_products": 164365, "total_shipping": 16000, "total_discounts_calc": 0, "current_state_name": "پرداخت تاييد شده", "order_date": "1400\/10\/30 18:05:52", "final_check": "OK" },],
            sort: true,
            search: true,
            resizable: true,

            pagination: {
                enabled: true,
                limit: 15,
                summary: true,
            },
            language: {
                'search': {
                    'placeholder': 'جستجو...'
                },
                sort: {
                    sortAsc: 'مرتب سازی بصورت صعودی',
                    sortDesc: 'مرتب سازی بصورت نزولی',
                },
                'pagination': {
                    'previous': 'قبلی',
                    'next': 'بعدی',
                    navigate: (page, pages) => `صفحه ${page} از ${pages}`,
                    page: (page) => `صفحه ${page}`,
                    'showing': 'نمایش',
                    'of': 'از',
                    'to': 'تا',
                    'results': () => 'نتایج'
                },
                'loading': 'در حال بارگذاری...',
                'noRecordsFound': 'چیزی یافت نشد',
                'error': 'هنگام دریافت داده ها خطایی رخ داد',

            },
        }).render(document.getElementById('showReportModal'));

        // Show toast 
        let finalNotOk = [91705, 91701, 91695, 91692, 91691];
        const notice = document.querySelector('.notice');

        if (finalNotOk.length == 0) {
            notice.innerText = 'بررسی نهایی تمامی سفارشات OK است'
        } else {
            notice.innerText = `سفارشات زیر را بررسی کنید.  (${finalNotOk.length})`
            finalNotOk.forEach(id => {
                const item = document.createElement('p')
                item.innerHTML = `${id}`
                document.querySelector('.toast-body').appendChild(item)
            });
        }

        //Close toast
        const closeBtn = document.querySelector('.close')
        closeBtn.addEventListener('click', () => {
            closeBtn.parentElement.classList.add('slide-out')
            setTimeout(() => {
                closeBtn.parentElement.style.display = 'none';
            }, 750);
        })

        // footer details data
        const infoArray = [{ "id": "totalPasargad", "report": "sales", "list": "payment", "title": "جمع درگاه پاسارگاد", "value": "119,246,341 تومان", "isCost": "TRUE" }, { "id": "totalMelli", "report": "sales", "list": "payment", "title": "جمع درگاه ملی", "value": "40,431,724 تومان", "isCost": "TRUE" }, { "id": "totalCOD", "report": "sales", "list": "payment", "title": "جمع تحویل در محل", "value": "0 تومان", "isCost": "TRUE" }, { "id": "totalDirect", "report": "sales", "list": "payment", "title": "جمع پرداخت مستقیم", "value": "0 تومان", "isCost": "TRUE" }, { "id": "ordersCount", "report": "sales", "list": "summary", "title": "تعداد سفارش‌ها", "value": "496 عدد", "isCost": "FALSE" }, { "id": "productsCount", "report": "sales", "list": "summary", "title": "تعداد محصولات", "value": "به زودی...", "isCost": "FALSE" }, { "id": "totalPaid", "report": "sales", "list": "summary", "title": "مجموع پرداختی", "value": "159,678,065 تومان", "isCost": "TRUE" }, { "id": "totalProducts", "report": "sales", "list": "summary", "title": "مجموع قیمت محصولات", "value": "162,196,450 تومان", "isCost": "TRUE" }, { "id": "totalShipping", "report": "sales", "list": "summary", "title": "مجموع هزینه‌های حمل", "value": "5,821,000 تومان", "isCost": "TRUE" }, { "id": "totalDiscount", "report": "sales", "list": "summary", "title": "مجموع تخفیف‌ها", "value": "8,339,385 تومان", "isCost": "TRUE" }];
        ;
        // Append items to DOM lists
        function appendListItem(params) {
            if (params) {
                const item = document.createElement("li")
                item.innerText = `${params.title}: ${params.value} ${params.isCost === "true" ? "تومان" : "عدد"}`
                document.querySelector(`.${params.list}-list`).appendChild(item)
            }
        }
        const footerDetails = document.querySelector(".bottom-details") // footer details box

        // condition of showing footer lists
        infoArray !== "NULL" ? infoArray.forEach(obj => appendListItem(obj)) : footerDetails.style.display = "none";


    </script>
</body>

</html>